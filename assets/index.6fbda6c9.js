import{r as u,j as e,F as x,a as T,b as s,d as b,c as L,e as z,f as D,g as _,h as O,i as F,k as M,R as W,l as Y}from"./vendor.e59ab956.js";const J=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))d(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const h of i.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&d(h)}).observe(document,{childList:!0,subtree:!0});function a(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function d(r){if(r.ep)return;r.ep=!0;const i=a(r);fetch(r.href,i)}};J();var N={google:{base:"https://youtube.googleapis.com/youtube/v3/search?key=AIzaSyCIlq-5vydLWLcPGzI4H3sGWm3YA3rCheI&part=snippet&type=video&",string:"maxResults=5&q=",related:"maxResults=1&relatedToVideoId="},ytmp3:{base:"https://youtube-mp36.p.rapidapi.com/dl?id=",headers:{"x-rapidapi-key":"1b0dbbddf1mshd3b40f307c84bb8p1ce739jsnd4c8e2a3e284","x-rapidapi-host":"youtube-mp36.p.rapidapi.com"}},PWA:{name:"YTPLAY",short_name:"YTPLAY",theme_color:"#ffffff",background_color:"#ffffff",display:"standalone",orientation:"portrait",icons:[{src:"/android-chrome-192x192.png",sizes:"192x192",type:"image/png"},{src:"/android-chrome-512x512.png",sizes:"512x512",type:"image/png"}]}};const R=u.exports.createContext(null);function U({children:t}){const n=u.exports.useRef(new Audio),[a,d]=u.exports.useState(!0),[r,i]=u.exports.useReducer(V,{next:[],prev:[]});async function h(c){try{const p=new URL(N.ytmp3.base+c),P=(await T.get(p,{headers:N.ytmp3.headers})).data.link;if(P.length)return P}catch(p){console.error(p)}return null}async function y(c){c<n.current.duration&&(n.current.currentTime=c)}async function f(){n.current.pause(),d(!0),r.next[0]&&(r.next[0].date<Date.now()-1e3*60*60*24&&(r.next[0].src=await h(r.next[0].id)||"",r.next[0].date=Date.now()),n.current.src=r.next[0].src,n.current.load(),n.current.play(),d(!1))}async function g(){n.current.src&&r.next[0].date>Date.now()-1e3*60*60*24?n.current.paused?(n.current.play(),d(!1)):(n.current.pause(),d(!0)):f()}async function m(){n.current.pause(),d(!0),r.next[1]&&(r.next[1].date<Date.now()-1e3*60*60*24&&(r.next[1].src=await h(r.next[1].id)||"",r.next[1].date=Date.now()),n.current.src=r.next[1].src,n.current.load(),n.current.play(),d(!1)),i({type:"play-next"})}async function v(){n.current.pause(),d(!0),r.prev[0]&&(r.prev[0].date<Date.now()-1e3*60*60*24&&(r.prev[0].src=await h(r.prev[0].id)||"",r.next[0].date=Date.now()),n.current.src=r.prev[0].src,n.current.load(),n.current.play(),d(!1)),i({type:"play-prev"})}async function $(c){n.current.pause(),c.date<Date.now()-1e3*60*60*24&&(c.src=await h(c.id)||"",c.date=Date.now()),n.current.src=c.src,n.current.load(),n.current.play(),d(!1),i({type:"play-now",payload:c})}function k(c){r.next[0]||(n.current.src=c.src,n.current.load(),n.current.play(),d(!1)),i({type:"add-next",payload:c})}function C(c){r.next[0]||(n.current.src=c.src,n.current.load(),n.current.play(),d(!1)),i({type:"add",payload:c})}function w(c){var p;((p=r.next[0])==null?void 0:p.id)===c.id&&(n.current.pause(),d(!0)),i({type:"remove",payload:c})}n.current.onended=m,u.exports.useEffect(()=>{const c=JSON.parse(localStorage.getItem("ytplay.next")),p=JSON.parse(localStorage.getItem("ytplay.prev")),A={next:(c==null?void 0:c.length)?c:[],prev:(p==null?void 0:p.length)?p:[]};i({type:"init",payload:A})},[]),u.exports.useEffect(()=>{localStorage.setItem("ytplay.next",JSON.stringify(r.next)),localStorage.setItem("ytplay.prev",JSON.stringify(r.prev)),console.log(r)});const I={audio:n,paused:a,state:r,updateAndPlay:y,loadAndPlay:f,toggleAudio:g,playNext:m,playPrev:v,playNow:$,addNext:k,add:C,remove:w};return e(x,{children:e(R.Provider,{value:I,children:t})})}function V(t,n){switch(n.type){case"play-next":return t.next[0]?{next:[...new Set(t.next.slice(1))],prev:[...new Set([t.next[0],...t.prev])]}:{next:[],prev:t.prev};case"play-prev":return t.prev[0]?{next:[...new Set([t.prev[0],...t.next])],prev:[...new Set(t.prev.slice(1))]}:{next:t.next,prev:[]};case"play-now":return t.next[0]?{next:[...new Set([n.payload,...t.next.slice(1)])],prev:[...new Set([t.next[0],...t.prev.filter(a=>a.id!==n.payload.id)])]}:{next:[n.payload],prev:t.prev};case"add-next":return t.next[0]?{next:[...new Set([t.next[0],n.payload,...t.next])],prev:t.prev}:{next:[n.payload],prev:t.prev};case"add":return{next:[...new Set([...t.next,n.payload])],prev:[...new Set(t.prev.filter(a=>a.id!==n.payload.id))]};case"remove":return{next:[...new Set(t.next.filter(a=>a.id!==n.payload.id))],prev:[...new Set(t.prev.filter(a=>a.id!==n.payload.id))]};case"init":return{next:[...new Set(n.payload.next)],prev:[...new Set(n.payload.prev)]}}}function B({song:t,paused:n,actions:a}){return e(x,{children:s("li",{className:"song",children:[e("img",{className:"img",src:t.img,alt:t.author}),s("div",{className:"info",children:[e("p",{children:e("span",{className:"title",children:t.title})}),e("p",{children:e("span",{className:"author",children:t.author})})]}),s("div",{className:"actions",children:[e("button",{onClick:()=>a[0](),children:n?e(b,{}):e(L,{})}),e("button",{onClick:()=>a[1](),children:e(z,{})}),e("button",{onClick:()=>a[2](t),children:e(D,{})})]})]})})}function G({raw:t,actions:n}){const a={id:t.id.videoId,date:Date.now(),src:null,title:t.snippet.title.replace(/\&[\S]{0,9}\;/g,""),author:t.snippet.channelTitle.replace(/\&[\S]{0,9}\;/g,""),img:t.snippet.thumbnails.high.url};return e(x,{children:s("li",{className:"song",children:[e("img",{className:"img",src:a.img,alt:a.author}),s("div",{className:"info",children:[e("p",{children:e("span",{className:"title",children:a.title})}),e("p",{children:e("span",{className:"author",children:a.author})})]}),s("div",{className:"actions",children:[e("button",{onClick:()=>n[0](a),children:e(b,{})}),e("button",{onClick:()=>n[1](a),children:e(_,{})}),e("button",{onClick:()=>n[2](a),children:e(O,{})})]})]})})}function H({song:t,actions:n}){return e(x,{children:s("li",{className:"song",children:[e("img",{className:"img",src:t.img,alt:t.author}),s("div",{className:"info",children:[e("p",{children:e("span",{className:"title",children:t.title})}),e("p",{children:e("span",{className:"author",children:t.author})})]}),s("div",{className:"actions",children:[e("button",{onClick:()=>n[0](t),children:e(b,{})}),e("button",{onClick:()=>n[1](t),children:e(_,{})}),e("button",{onClick:()=>n[2](t),children:e(D,{})})]})]})})}function K({song:t,actions:n}){return e(x,{children:s("li",{className:"song",children:[e("img",{className:"img",src:t.img,alt:t.author}),s("div",{className:"info",children:[e("p",{children:e("span",{className:"title",children:t.title})}),e("p",{children:e("span",{className:"author",children:t.author})})]}),s("div",{className:"actions",children:[e("button",{onClick:()=>n[0](t),children:e(b,{})}),e("button",{onClick:()=>n[1](t),children:e(O,{})}),e("button",{onClick:()=>n[2](t),children:e(D,{})})]})]})})}function Q(){const{state:t,paused:n,loadAndPlay:a,toggleAudio:d,playNow:r,addNext:i,add:h,remove:y}=u.exports.useContext(R),[f,g]=u.exports.useState(!1),[m,v]=u.exports.useState([]),[$,k]=u.exports.useState(""),C=u.exports.useRef();function w(){v([]),k("")}function I(l){clearTimeout(C.current);const{value:o}=l.target;k(o),C.current=setTimeout(()=>c(o),800)}async function c(l){if(!(l.length<4))try{const o=new URL(N.google.base+N.google.string+l),S=(await T.get(o)).data.items;S.length&&v(S)}catch(o){console.error(o)}}async function p(l){try{const o=new URL(N.ytmp3.base+l.id),S=(await T.get(o,{headers:N.ytmp3.headers})).data.link;if(S.length)return l.src=S,l}catch(o){console.error(o)}return null}async function A(l){const o=await p(l);o&&r(o),w()}async function P(l){const o=await p(l);o&&i(o),w()}async function E(l){const o=await p(l);o&&h(o),w()}return u.exports.useEffect(()=>{t.next[0]||g(!0)}),e(x,{children:s("section",{className:`search ${f?"expand":""}`,children:[s("div",{id:"yt-search",children:[e("button",{className:f?"expand":"",onClick:()=>g(!1)}),e("input",{className:f?"expand":"",type:"text",onFocus:()=>g(!0),onChange:I,value:$})]}),s("article",{className:`hidden ${f?"display":""}`,children:[s("ul",{className:`search-result ${m.length?"":"hide"}`,children:[e("h3",{children:"Wyniki"}),m.map(l=>e(G,{raw:l,actions:[A,P,E]},l.etag))]}),s("ul",{className:"playlist now",children:[e("h3",{children:"Teraz"}),t.next[0]?e(B,{song:t.next[0],paused:n,actions:[d,a,y]}):null]}),s("ul",{className:"playlist next",children:[e("h3",{children:"W kolejce"}),t.next.map((l,o)=>o?e(H,{song:l,actions:[r,i,y]},l.id):null)]}),s("ul",{className:"playlist prev",children:[e("h3",{children:"Wcze\u015Bniejsze"}),t.prev.map(l=>e(K,{song:l,actions:[r,h,y]},l.id))]})]})]})})}function X(){const{state:t}=u.exports.useContext(R);return e(x,{children:e("section",{className:"view",style:{backgroundImage:`url( ${t.next[0]?t.next[0].img:""} )`}})})}function Z(){const{audio:t,state:n,paused:a,updateAndPlay:d,loadAndPlay:r,toggleAudio:i,playNext:h,playPrev:y}=u.exports.useContext(R),f=u.exports.useRef();function g(v){d(v.target.value),m()}function m(){document.querySelector("#input-timing .track").max=t.current.duration,document.querySelector("#input-timing .track").value=t.current.currentTime,document.querySelector("#input-timing .t-end").textContent=q(t.current.duration),document.querySelector("#input-timing .t-now").textContent=q(t.current.currentTime),f.current=requestAnimationFrame(m)}return u.exports.useEffect(()=>(m(),()=>{cancelAnimationFrame(f.current)}),[]),e(x,{children:s("section",{className:"play",children:[s("div",{className:"row info",children:[e("p",{id:"animated-song-title",children:e("span",{className:"title",children:n.next[0]?n.next[0].title:""})}),e("p",{children:e("span",{className:"author",children:n.next[0]?n.next[0].author:""})})]}),s("div",{className:"row timing",id:"input-timing",children:[e("input",{className:"track",type:"range",min:0,max:0,onTouchStart:()=>cancelAnimationFrame(f.current),onTouchEnd:g}),e("span",{className:"t-now",children:"0:00"}),e("span",{className:"t-end",children:"0:00"})]}),s("div",{className:"row actions",children:[e("button",{className:"skip-prev",onClick:r,onDoubleClick:y,children:e(F,{})}),e("button",{className:"play-pause",onClick:i,children:a?e(b,{}):e(L,{})}),e("button",{className:"skip-next",onClick:h,children:e(M,{})})]})]})})}function q(t){return Number.isNaN(t)?"0:00":`${Math.floor(t/60)}:${Math.ceil(t)%60>9?Math.ceil(t)%60:"0"+Math.ceil(t)%60}`}function ee(){return e(x,{children:s(U,{children:[e(Q,{}),e(X,{}),e(Z,{})]})})}W.render(e(Y.StrictMode,{children:e(ee,{})}),document.getElementById("root"));
