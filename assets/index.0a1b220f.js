import{r as u,j as e,F as x,a as T,b as o,d as b,c as L,e as z,f as D,g as _,h as q,i as M,k as F,R as W,l as Y}from"./vendor.e59ab956.js";const J=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))h(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const p of s.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&h(p)}).observe(document,{childList:!0,subtree:!0});function a(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function h(r){if(r.ep)return;r.ep=!0;const s=a(r);fetch(r.href,s)}};J();var N={google:{base:"https://youtube.googleapis.com/youtube/v3/search?key=AIzaSyCIlq-5vydLWLcPGzI4H3sGWm3YA3rCheI&part=snippet&type=video&",string:"maxResults=5&q=",related:"maxResults=1&relatedToVideoId="},ytmp3:{base:"https://youtube-mp36.p.rapidapi.com/dl?id=",headers:{"x-rapidapi-key":"1b0dbbddf1mshd3b40f307c84bb8p1ce739jsnd4c8e2a3e284","x-rapidapi-host":"youtube-mp36.p.rapidapi.com"}},PWA:{name:"YTPLAY",short_name:"YTPLAY",theme_color:"#ffffff",background_color:"#ffffff",display:"standalone",orientation:"portrait",icons:[{src:"/android-chrome-192x192.png",sizes:"192x192",type:"image/png"},{src:"/android-chrome-512x512.png",sizes:"512x512",type:"image/png"}]}};const R=u.exports.createContext(null);function U({children:t}){const n=u.exports.useRef(new Audio),[a,h]=u.exports.useState(!0),[r,s]=u.exports.useReducer(V,{next:[],prev:[]});async function p(c){try{const d=new URL(N.ytmp3.base+c),P=(await T.get(d,{headers:N.ytmp3.headers})).data.link;if(P.length)return P}catch(d){console.error(d),alert(d.message)}return null}async function y(c){c<n.current.duration&&(n.current.currentTime=c)}async function m(){n.current.pause(),r.next[0]&&(r.next[0].date<Date.now()-1e3*60*60*24&&(r.next[0].src=await p(r.next[0].id)||"",r.next[0].date=Date.now()),n.current.src=r.next[0].src,n.current.load(),n.current.play())}async function g(){n.current.src&&r.next[0].date>Date.now()-1e3*60*60*24?n.current.paused?n.current.play():n.current.pause():m()}async function f(){n.current.pause(),r.next[1]&&(r.next[1].date<Date.now()-1e3*60*60*24&&(r.next[1].src=await p(r.next[1].id)||"",r.next[1].date=Date.now()),n.current.src=r.next[1].src,n.current.load(),n.current.play()),s({type:"play-next"})}async function v(){n.current.pause(),r.prev[0]&&(r.prev[0].date<Date.now()-1e3*60*60*24&&(r.prev[0].src=await p(r.prev[0].id)||"",r.next[0].date=Date.now()),n.current.src=r.prev[0].src,n.current.load(),n.current.play()),s({type:"play-prev"})}async function $(c){n.current.pause(),c.date<Date.now()-1e3*60*60*24&&(c.src=await p(c.id)||"",c.date=Date.now()),n.current.src=c.src,n.current.load(),n.current.play(),s({type:"play-now",payload:c})}function k(c){r.next[0]||(n.current.src=c.src,n.current.load(),n.current.play()),s({type:"add-next",payload:c})}function C(c){r.next[0]||(n.current.src=c.src,n.current.load(),n.current.play()),s({type:"add",payload:c})}function w(c){var d;((d=r.next[0])==null?void 0:d.id)===c.id&&n.current.pause(),s({type:"remove",payload:c})}n.current.onended=f,n.current.onplay=()=>h(!1),n.current.onpause=()=>h(!0),u.exports.useEffect(()=>{const c=JSON.parse(localStorage.getItem("ytplay.next")),d=JSON.parse(localStorage.getItem("ytplay.prev")),A={next:(c==null?void 0:c.length)?c:[],prev:(d==null?void 0:d.length)?d:[]};s({type:"init",payload:A})},[]),u.exports.useEffect(()=>{localStorage.setItem("ytplay.next",JSON.stringify(r.next)),localStorage.setItem("ytplay.prev",JSON.stringify(r.prev))});const I={audio:n,paused:a,state:r,updateAndPlay:y,loadAndPlay:m,toggleAudio:g,playNext:f,playPrev:v,playNow:$,addNext:k,add:C,remove:w};return e(x,{children:e(R.Provider,{value:I,children:t})})}function V(t,n){switch(n.type){case"play-next":return t.next[0]?{next:[...new Set(t.next.slice(1))],prev:[...new Set([t.next[0],...t.prev])]}:{next:[],prev:t.prev};case"play-prev":return t.prev[0]?{next:[...new Set([t.prev[0],...t.next])],prev:[...new Set(t.prev.slice(1))]}:{next:t.next,prev:[]};case"play-now":return t.next[0]?{next:[...new Set([n.payload,...t.next.slice(1)])],prev:[...new Set([t.next[0],...t.prev.filter(a=>a.id!==n.payload.id)])]}:{next:[n.payload],prev:t.prev.filter(a=>a.id!==n.payload.id)};case"add-next":return t.next[0]?{next:[...new Set([t.next[0],n.payload,...t.next])],prev:t.prev}:{next:[n.payload],prev:t.prev};case"add":return{next:[...new Set([...t.next,n.payload])],prev:[...new Set(t.prev.filter(a=>a.id!==n.payload.id))]};case"remove":return{next:[...new Set(t.next.filter(a=>a.id!==n.payload.id))],prev:[...new Set(t.prev.filter(a=>a.id!==n.payload.id))]};case"init":return{next:[...new Set(n.payload.next)],prev:[...new Set(n.payload.prev)]}}}function B({song:t,paused:n,actions:a}){return e(x,{children:o("li",{className:"song",children:[e("img",{className:"img",src:t.img,alt:t.author}),o("div",{className:"info",children:[e("p",{className:"title",children:e("span",{children:t.title})}),e("p",{className:"author",children:e("span",{children:t.author})})]}),o("div",{className:"actions",children:[e("button",{onClick:()=>a[0](),children:n?e(b,{}):e(L,{})}),e("button",{onClick:()=>a[1](),children:e(z,{})}),e("button",{onClick:()=>a[2](t),children:e(D,{})})]})]})})}function G({raw:t,actions:n}){const a={id:t.id.videoId,date:Date.now(),src:null,title:t.snippet.title.replace(/\&[\S]{0,9}\;/g,""),author:t.snippet.channelTitle.replace(/\&[\S]{0,9}\;/g,""),img:t.snippet.thumbnails.high.url};return e(x,{children:o("li",{className:"song",children:[e("img",{className:"img",src:a.img,alt:a.author}),o("div",{className:"info",children:[e("p",{className:"title",children:e("span",{children:a.title})}),e("p",{className:"author",children:e("span",{children:a.author})})]}),o("div",{className:"actions",children:[e("button",{onClick:()=>n[0](a),children:e(b,{})}),e("button",{onClick:()=>n[1](a),children:e(_,{})}),e("button",{onClick:()=>n[2](a),children:e(q,{})})]})]})})}function H({song:t,actions:n}){return e(x,{children:o("li",{className:"song",children:[e("img",{className:"img",src:t.img,alt:t.author}),o("div",{className:"info",children:[e("p",{className:"title",children:e("span",{children:t.title})}),e("p",{className:"author",children:e("span",{children:t.author})})]}),o("div",{className:"actions",children:[e("button",{onClick:()=>n[0](t),children:e(b,{})}),e("button",{onClick:()=>n[1](t),children:e(_,{})}),e("button",{onClick:()=>n[2](t),children:e(D,{})})]})]})})}function K({song:t,actions:n}){return e(x,{children:o("li",{className:"song",children:[e("img",{className:"img",src:t.img,alt:t.author}),o("div",{className:"info",children:[e("p",{className:"title",children:e("span",{children:t.title})}),e("p",{className:"author",children:e("span",{children:t.author})})]}),o("div",{className:"actions",children:[e("button",{onClick:()=>n[0](t),children:e(b,{})}),e("button",{onClick:()=>n[1](t),children:e(q,{})}),e("button",{onClick:()=>n[2](t),children:e(D,{})})]})]})})}function Q(){const{state:t,paused:n,loadAndPlay:a,toggleAudio:h,playNow:r,addNext:s,add:p,remove:y}=u.exports.useContext(R),[m,g]=u.exports.useState(!1),[f,v]=u.exports.useState([]),[$,k]=u.exports.useState(""),C=u.exports.useRef();function w(){v([]),k("")}function I(i){clearTimeout(C.current);const{value:l}=i.target;k(l),C.current=setTimeout(()=>c(l),800)}async function c(i){if(!(i.length<4))try{const l=new URL(N.google.base+N.google.string+i),S=(await T.get(l)).data.items;S.length&&v(S)}catch(l){console.error(l),alert(l.message)}}async function d(i){try{const l=new URL(N.ytmp3.base+i.id),S=(await T.get(l,{headers:N.ytmp3.headers})).data.link;if(S.length)return i.src=S,i}catch(l){console.error(l),alert(l.message)}return null}async function A(i){const l=await d(i);l&&r(l),w()}async function P(i){const l=await d(i);l&&s(l),w()}async function O(i){const l=await d(i);l&&p(l),w()}return u.exports.useEffect(()=>{t.next[0]||g(!0)}),e(x,{children:o("section",{className:`search ${m?"expand":""}`,children:[e("button",{className:`toggler ${m?"expand":""}`,onClick:()=>g(i=>!i)}),e("input",{className:"search-bar",type:"text",onChange:I,value:$,placeholder:"Szukaj"}),o("article",{className:"menu",children:[o("ul",{className:`playlist ${f.length?"":"hide"}`,children:[e("h3",{children:"Wyniki"}),f.map(i=>e(G,{raw:i,actions:[A,P,O]},i.etag))]}),o("ul",{className:`playlist ${t.next[0]?"":"hide"}`,children:[e("h3",{children:"Teraz"}),t.next[0]?e(B,{song:t.next[0],paused:n,actions:[h,a,y]}):null]}),o("ul",{className:`playlist ${t.next[1]?"":"hide"}`,children:[e("h3",{children:"W kolejce"}),t.next.map((i,l)=>l?e(H,{song:i,actions:[r,s,y]},i.id):null)]}),o("ul",{className:`playlist ${t.prev[0]?"":"hide"}`,children:[e("h3",{children:"Wcze\u015Bniejsze"}),t.prev.map(i=>e(K,{song:i,actions:[r,p,y]},i.id))]})]})]})})}function X(){const{state:t}=u.exports.useContext(R);return u.exports.useEffect(()=>{document.querySelector("body").style.backgroundImage=`url( ${t.next[0]?t.next[0].img:""} )`}),e(x,{children:e("section",{className:"view",style:{backgroundImage:`url( ${t.next[0]?t.next[0].img:""} )`}})})}function Z(){const{audio:t,state:n,paused:a,updateAndPlay:h,loadAndPlay:r,toggleAudio:s,playNext:p,playPrev:y}=u.exports.useContext(R),m=u.exports.useRef();function g(v){h(v.target.value),f()}function f(){document.querySelector("#input-timing .track").max=t.current.duration,document.querySelector("#input-timing .track").value=t.current.currentTime,document.querySelector("#input-timing .t-end").textContent=E(t.current.duration),document.querySelector("#input-timing .t-now").textContent=E(t.current.currentTime),m.current=requestAnimationFrame(f)}return u.exports.useEffect(()=>(f(),()=>{cancelAnimationFrame(m.current)}),[]),e(x,{children:o("section",{className:"play",children:[o("div",{className:"row info",children:[e("p",{className:"title",children:e("span",{children:n.next[0]?n.next[0].title:""})}),e("p",{className:"author",children:e("span",{children:n.next[0]?n.next[0].author:""})})]}),o("div",{className:"row actions",children:[e("button",{className:"skip-prev",onClick:r,onDoubleClick:y,children:e(M,{})}),e("button",{className:"play-pause",onClick:s,children:a?e(b,{}):e(L,{})}),e("button",{className:"skip-next",onClick:p,children:e(F,{})})]}),o("div",{className:"row timing",id:"input-timing",children:[e("span",{className:"t-now",children:"0:00"}),e("span",{className:"t-end",children:"0:00"}),e("input",{className:"track",type:"range",min:0,max:0,onTouchStart:()=>cancelAnimationFrame(m.current),onTouchEnd:g})]})]})})}function E(t){return Number.isNaN(t)?"0:00":`${Math.floor(t/60)}:${Math.ceil(t)%60>9?Math.ceil(t)%60:"0"+Math.ceil(t)%60}`}function ee(){return e(x,{children:o(U,{children:[e(Q,{}),e(X,{}),e(Z,{})]})})}W.render(e(Y.StrictMode,{children:e(ee,{})}),document.getElementById("root"));
